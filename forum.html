<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Forum Â· æ˜¥æ¸¸å°åˆ†é˜Ÿ</title>

  <style>
    :root{
      --bg1:#fff7fb;
      --bg2:#f3fbff;
      --bg3:#fffdf3;
      --card:#ffffffd9;
      --text:#2b2b2b;
      --muted:#666;
      --primary:#6aa9ff;
      --primary2:#ff9fd2;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      color:var(--text);
      min-height:100vh;
      overflow-x:hidden;
      background:
        radial-gradient(900px 500px at 10% 10%, var(--bg1), transparent 60%),
        radial-gradient(900px 500px at 90% 10%, var(--bg2), transparent 60%),
        radial-gradient(900px 500px at 50% 90%, var(--bg3), transparent 60%),
        linear-gradient(180deg, #ffffff, #fbfbff);
    }

    /* ç²’å­ canvas */
    #particles{
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      z-index:-1;
    }

    header{
      width:min(980px, 92vw);
      margin:22px auto 0;
      padding:18px 18px 10px;
      background:var(--card);
      border:1px solid rgba(255,255,255,.7);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    header h1{
      margin:0;
      font-size:22px;
      letter-spacing:.3px;
    }
    header p{
      margin:8px 0 0;
      color:var(--muted);
      line-height:1.6;
    }

    .toolbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:12px;
    }

    .btn{
      border:none;
      cursor:pointer;
      padding:10px 14px;
      border-radius:14px;
      color:#fff;
      background: linear-gradient(90deg, var(--primary), var(--primary2));
      box-shadow: 0 10px 18px rgba(255,159,210,.18);
      font-size:14px;
    }
    .btn:hover{filter:brightness(.98)}
    .btn.secondary{
      background:#ffffff;
      color:#333;
      border:1px solid rgba(0,0,0,.08);
      box-shadow:none;
    }

    main{
      width:min(980px, 92vw);
      margin:14px auto 30px;
      padding:18px;
      background:var(--card);
      border:1px solid rgba(255,255,255,.7);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .grid{display:grid;grid-template-columns:1fr;gap:14px}
    .panel{
      background:#fff;
      border-radius:16px;
      border:1px solid rgba(0,0,0,.06);
      padding:14px;
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    label{font-size:13px;color:var(--muted)}
    input[type="text"]{
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(0,0,0,.08);
      outline:none;
      min-width:220px;
      background:#fff;
    }
    .chip{
      padding:8px 12px;
      border-radius:999px;
      background:#fff;
      border:1px solid rgba(0,0,0,.06);
      font-size:13px;
      color:#444;
    }

    .giscus-wrap{padding:10px 4px 0;}

    footer{
      width:min(980px, 92vw);
      margin:0 auto 26px;
      text-align:center;
      color:#777;
      font-size:14px;
    }

    /* ===== æµ…è‰²æ’­æ”¾å™¨ï¼ˆPlaylistï¼‰ ===== */
    #bgm-player{
      position: fixed;
      right: 16px;
      bottom: 16px;
      width: 320px;
      max-width: calc(100vw - 32px);
      background: rgba(255,255,255,0.85);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.12);
      padding: 12px;
      z-index: 9999;
      color: #222;
    }
    #bgm-player .bgm-title{font-weight:700;margin-bottom:8px;}
    #bgm-audio{width:100%;}
    #bgm-player .bgm-controls{
      display:flex;align-items:center;gap:10px;margin-top:10px;
    }
    #bgm-player button{
      border:none;border-radius:10px;padding:8px 10px;cursor:pointer;
      background:#f0f2f5;
    }
    #bgm-player button:hover{background:#e6e9ef;}
    #bgm-player .bgm-loop{margin-left:auto;font-size:14px;user-select:none;}
    #bgm-list{
      list-style:none;padding:0;margin:10px 0 0 0;
      max-height:160px;overflow:auto;
    }
    #bgm-list li{
      padding:8px 10px;border-radius:10px;cursor:pointer;
      background: rgba(0,0,0,0.04);
      margin-bottom: 8px;
    }
    #bgm-list li:hover{background: rgba(0,0,0,0.07);}
    #bgm-list li.active{
      outline: 2px solid rgba(0,123,255,0.45);
      background: rgba(0,123,255,0.10);
    }
  </style>
</head>

<body>
  <canvas id="particles"></canvas>

  <header>
    <h1>ğŸ’¬ Forum / å…±äº«ç•™è¨€æ¿</h1>
    <p>
      è¿™é‡Œç”¨ <strong>giscus</strong>ï¼ˆGitHub Discussionsï¼‰åšè¯„è®ºåŒº/è®ºå›ã€‚
      ä½ å¯ä»¥å…ˆè®¾ç½®ä¸€ä¸ªâ€œé¡µé¢æ˜µç§°â€ï¼ˆåªåœ¨æœ¬é¡µæ˜¾ç¤ºï¼‰ï¼Œç„¶ååœ¨ä¸‹æ–¹å‘è¨€ã€‚
    </p>

    <div class="toolbar">
      <button class="btn secondary" onclick="location.href='index.html'">â† è¿”å›é¦–é¡µ</button>
      <button class="btn" onclick="scrollToComments()">è·³åˆ°ç•™è¨€åŒº</button>
    </div>
  </header>

  <main>
    <div class="grid">
      <div class="panel">
        <div class="row">
          <div>
            <label>ä½ çš„é¡µé¢æ˜µç§°ï¼ˆä»…æœ¬é¡µæ˜¾ç¤ºï¼Œä¼šä¿å­˜åœ¨æµè§ˆå™¨ï¼‰</label><br/>
            <input id="nickname" type="text" placeholder="æ¯”å¦‚ï¼šQin / Feihan / å°ä¼™ä¼´" maxlength="24"/>
          </div>
          <div>
            <button class="btn" onclick="saveNick()">ä¿å­˜æ˜µç§°</button>
          </div>
          <div class="chip" id="nickDisplay">å½“å‰æ˜µç§°ï¼šæœªè®¾ç½®</div>
          <div class="chip">æç¤ºï¼šæµè§ˆå™¨é€šå¸¸ç¦æ­¢è‡ªåŠ¨æ’­æ”¾ï¼Œéœ€æ‰‹åŠ¨ç‚¹æ’­æ”¾å™¨æŒ‰é’®ä¸€æ¬¡</div>
        </div>
      </div>

      <div class="panel" id="comments">
        <h2 style="margin:0 0 8px;">ğŸ“ ç•™è¨€åŒºï¼ˆgiscusï¼‰</h2>
        <div class="giscus-wrap">
          <script src="https://giscus.app/client.js"
              data-repo="71Qin/JobEntertainment"
              data-repo-id="R_kgDOQt7F2w"
              data-category="General"
              data-category-id="DIC_kwDOQt7F284C0Mzm"
              data-mapping="pathname"
              data-strict="0"
              data-reactions-enabled="1"
              data-emit-metadata="0"
              data-input-position="bottom"
              data-theme="preferred_color_scheme"
              data-lang="zh-CN"
              crossorigin="anonymous"
              async>
          </script>
        </div>
      </div>
    </div>
  </main>

  <footer>Â© 2025 JobEntertainment Â· Forum</footer>

  <!-- ğŸµ åªä¿ç•™è¿™ä¸€å¥— BGM æ’­æ”¾å™¨ï¼ˆPlaylistï¼‰ -->
  <div id="bgm-player">
    <div class="bgm-title">ğŸµ Background Music</div>
    <audio id="bgm-audio" controls preload="metadata" playsinline></audio>

    <div class="bgm-controls">
      <button id="prevBtn">â®</button>
      <button id="playBtn">â–¶</button>
      <button id="nextBtn">â­</button>
      <label class="bgm-loop">
        <input type="checkbox" id="loopChk" />
        Loop
      </label>
    </div>

    <ul id="bgm-list"></ul>
  </div>

  <script>
    // ====== æ˜µç§°ï¼šlocalStorage ======
    const nickInput = document.getElementById("nickname");
    const nickDisplay = document.getElementById("nickDisplay");

    function loadNick(){
      const saved = localStorage.getItem("JE_NICKNAME") || "";
      if(saved){
        nickInput.value = saved;
        nickDisplay.textContent = "å½“å‰æ˜µç§°ï¼š" + saved;
      }else{
        nickDisplay.textContent = "å½“å‰æ˜µç§°ï¼šæœªè®¾ç½®";
      }
    }

    function saveNick(){
      const v = (nickInput.value || "").trim();
      if(!v){
        localStorage.removeItem("JE_NICKNAME");
        nickDisplay.textContent = "å½“å‰æ˜µç§°ï¼šæœªè®¾ç½®";
        alert("å·²æ¸…ç©ºæ˜µç§°");
        return;
      }
      localStorage.setItem("JE_NICKNAME", v);
      nickDisplay.textContent = "å½“å‰æ˜µç§°ï¼š" + v;
      alert("æ˜µç§°å·²ä¿å­˜");
    }

    function scrollToComments(){
      document.getElementById("comments").scrollIntoView({behavior:"smooth", block:"start"});
    }

    loadNick();

    // ====== å½©è‰²ç²’å­èƒŒæ™¯ ======
    const canvas = document.getElementById("particles");
    const ctx = canvas.getContext("2d");

    let W, H, dpr;
    function resize(){
      dpr = Math.max(1, window.devicePixelRatio || 1);
      W = canvas.width = Math.floor(window.innerWidth * dpr);
      H = canvas.height = Math.floor(window.innerHeight * dpr);
      canvas.style.width = window.innerWidth + "px";
      canvas.style.height = window.innerHeight + "px";
    }
    window.addEventListener("resize", resize);
    resize();

    const pastel = [
      "rgba(255, 173, 214, 0.55)",
      "rgba(170, 216, 255, 0.55)",
      "rgba(255, 231, 170, 0.55)",
      "rgba(196, 255, 214, 0.55)",
      "rgba(212, 192, 255, 0.55)"
    ];

    const N = 70;
    const particles = Array.from({length:N}, () => ({
      x: Math.random() * W,
      y: Math.random() * H,
      r: (Math.random() * 3 + 1) * dpr,
      vx: (Math.random() * 0.6 - 0.3) * dpr,
      vy: (Math.random() * 0.6 - 0.3) * dpr,
      c: pastel[(Math.random()*pastel.length)|0]
    }));

    function tick(){
      ctx.clearRect(0,0,W,H);

      // è½»å¾®é›¾åŒ–åº•è‰²ï¼ˆä¿æŒæµ…è‰²ï¼‰
      ctx.fillStyle = "rgba(255,255,255,0.08)";
      ctx.fillRect(0,0,W,H);

      for(const p of particles){
        p.x += p.vx;
        p.y += p.vy;

        if(p.x < -20*dpr) p.x = W + 20*dpr;
        if(p.x > W + 20*dpr) p.x = -20*dpr;
        if(p.y < -20*dpr) p.y = H + 20*dpr;
        if(p.y > H + 20*dpr) p.y = -20*dpr;

        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fillStyle = p.c;
        ctx.fill();
      }

      // è¿æ¥çº¿
      for(let i=0;i<N;i++){
        for(let j=i+1;j<N;j++){
          const a = particles[i], b = particles[j];
          const dx = a.x - b.x, dy = a.y - b.y;
          const dist = Math.sqrt(dx*dx + dy*dy);
          const max = 140 * dpr;
          if(dist < max){
            const alpha = (1 - dist/max) * 0.12;
            ctx.strokeStyle = `rgba(120,120,140,${alpha})`;
            ctx.lineWidth = 1 * dpr;
            ctx.beginPath();
            ctx.moveTo(a.x,a.y);
            ctx.lineTo(b.x,b.y);
            ctx.stroke();
          }
        }
      }

      requestAnimationFrame(tick);
    }
    tick();

    const PLAYLIST = [
      { title: "I Miss You", src: "assets/I Miss You-ç½—ç™¾å‰&å®è´.m4a" },
      { title: "ç”»", src: "assets/é‚“ç´«æ£‹-ç”».m4a" },
      { title: "Sakura Tears", src: "assets/Sakura Tears.m4a" },
    ];

    const audio = document.getElementById("bgm-audio");
    const listEl = document.getElementById("bgm-list");
    const playBtn = document.getElementById("playBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const loopChk = document.getElementById("loopChk");

    let idx = 0;

    function renderList(){
      listEl.innerHTML = "";
      PLAYLIST.forEach((t, i) => {
        const li = document.createElement("li");
        li.textContent = t.title;
        li.className = (i === idx) ? "active" : "";
        li.onclick = async () => {
          idx = i;
          loadTrack();
          // ç‚¹å‡»åˆ—è¡¨å±äºâ€œç”¨æˆ·æ‰‹åŠ¿â€ï¼Œå¯ä»¥å°è¯•ç›´æ¥æ’­æ”¾
          try{ await audio.play(); playBtn.textContent="â¸"; }catch(e){ playBtn.textContent="â–¶"; }
        };
        listEl.appendChild(li);
      });
    }

    function loadTrack(){
      audio.src = PLAYLIST[idx].src;
      renderList();
    }

    function playOrPause(){
      if (audio.paused){
        audio.play().then(()=> playBtn.textContent="â¸").catch(()=>{});
      }else{
        audio.pause();
        playBtn.textContent="â–¶";
      }
    }

    function prev(){
      idx = (idx - 1 + PLAYLIST.length) % PLAYLIST.length;
      loadTrack();
      audio.play().then(()=> playBtn.textContent="â¸").catch(()=>{ playBtn.textContent="â–¶"; });
    }

    function next(){
      idx = (idx + 1) % PLAYLIST.length;
      loadTrack();
      audio.play().then(()=> playBtn.textContent="â¸").catch(()=>{ playBtn.textContent="â–¶"; });
    }

    audio.addEventListener("ended", () => {
      if (!audio.loop) next();
    });

    loopChk.addEventListener("change", () => {
      audio.loop = loopChk.checked;
    });

    playBtn.addEventListener("click", playOrPause);
    prevBtn.addEventListener("click", prev);
    nextBtn.addEventListener("click", next);

    // åˆå§‹åŒ–
    loadTrack();
  </script>
</body>
</html>
